language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: w2Wgyrn9n+OJjkmoTUm7MU4+RQr8JhhPxA/dj8gvsj77LtxApuBnlcB2xZALKc/qvlvhYCJsefmc8gEzyqoFXyh4iwtQTb01LA3CU/GbeVVBnlNYYB2xnrGrhcQjbX9/xWfd9jaXQy3Q3fjWEE2Ya/SItSPo0oWVUhgUBpgZXMyLe/K7Hk9Le+iPURCFl2EqRadCKHSyOIqoytjTEKOZSyKBc70ThFPWOIXQOr10TOPIJe1vtbLKNWk0njmCW8nOdz1AEnD5tCDzVyV/JyR4E3gCw4/4yETkR5xefpTLX1hJIbxbNEPVdN6G6Cuqzq89K3paHORaWukh5VNPuX917PErjS5nRJt0Xjb4HjD9o/baytuflOlhnqvoUxyeQFmapI+uNUXRRL94ikz8uVWXDZW+fKJLT7bztd+7r0I0a0O1AxjcoOOIoOJ7MYTYN7UIMq5dzhWfi3mJ/6pInfoSfJvGb0I7YkTCa10Gzrfa80YV+pPb9u5eNI+71q4VNpfNxxSSz0Dm3v2EdlBF4J+tVsIb3h3ag3UvdhV3qEaY/PskImyasQNQQRVXdZB/5jmk8K4rS2v7afVWtOfT5q5h1+v4+BaHQBfq/QS9dcSkzX6trFEtXGedUaAJT4HnjPHSWkdit5wPrT9HAevsaMRxvZHVmm0GLELOKYEAKDx1mxA=
  file: "target/spt-development-cid-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true