language: java

jdk:
  - openjdk8

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: JEfCpZYaUKPfgb+PXtiT3M1HK5UEf12vZ3xEei1hq6CmecQXCZB/qt1PPC0DSO37PbMLc1E/nL9vKLniulqwGwNKIuipP3uKCQqPwv06+VFk9HWzRyq/GyTQtqZVRFor8drilK1T9qL/t2TYLGF1aXt9oD/sdWyReWNIKNfPj18WsnxdFw3QHt4/UnD9Rfxm+087csKCp82plAlhjzcor0JEBlKBPFQtVJN4yoScu/h5WWQshhq/8EaaKIrhvgzhzKLYSBdPWzKow2C55PfbGA+mI1DdG43twbhQYEd5m2pOAmMx/69dv1IEnaekRVxa28ge8WT9QarG0N5dleE3Gu1ukbXFlXJq/viGT3js0QjmsOPPXHmw1+I6IR4bFj3tad2FJr46/qldfGDzHrxxahxvZNaTiis/RwIyZTfE70sEsEo6R2qCr7qZ7/avLogDDMotz1rwsz5mVgW0QYa/wXeNoI1f9XNe6sZzDJ3eJd+JwBT9Kw0MdAo+OMXibfVoFAcNvEa5w2WoT0/j4vBRhJ3uWKFSdJmcXmReGd1KOxT/5Q34QkVwvUqY2jHfhDuiWk53wd84Q+zo843Kt6aZqOPErmWh3VNyG07ck4p/dhUIWnjAS3epCAwOlC6+G8tm+3ZwFz6Xi2YOklcS+aqIzxYvYQWH5yRqIRSAoz07rJ0=
  file: "target/spt-development-cid-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true