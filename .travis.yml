language: java

jdk:
  - openjdk15

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: KzkRxnECIT975me/IB1SF/7qylQMoA+ObKAoM9joeCGEEPJVc1yClte73mTlLeELcogo8MWLH1uKwo2ERdopww1MdB5vtCYo08h0rPtAuNlIecKjaiCVnRp+LNg2W0WsgULId4NCzusZiOMt/o9wUl5uS6UJ8ohcAp4CXrhGhKAr7VHgMxslwdCvS6W+dghRHuKGCX+U4HzOvhrAnFV4r6hDsBTNUQYCQcaIef4GbmxsOC8ea25ZOLChWkIy/55Zox0OZ8l3tpd2gI6caZOt1304DTdKzmWdNzOlHTk7vHBTy8uOk5j3bD4lXTBm5ZLIXuDJ4PCOwtQtjD6ES3ImHbdUuQWsvSIGLzXgBPPbqHAKwmp4MF8cyuwDT+AZZc0yomNZzD9YB9A/+nzm0JISLZ6YgQ84MviXISPKEMgwnNCL/O7ZF/LnhkD0XIiudk0WhmUINifjtaK5BwjMSkBJAbJD8Yq8i1rcul5RpJVkuw7VEeIkjUsPG3Wdnx8Ji/N+8XIX+0OMtalTlnBlp9ewch+/n9jEpi8+IsFR3GvZsSAzgIBDfb39KBtxxLtm9dps2jMWyPprPK1osFHPMvm9VJVANNNcEdqoh3ClSrta0JYCpHKv6o8ovcx1eIN0zaXvWU6vbRXEFrzz73iujyLVFNvxRFoYKhC6YnReYUEVesk=
  file: "target/spt-development-cid-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true