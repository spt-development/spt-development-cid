language: java

jdk:
  - openjdk15

script:
  - mvn test -B
  - mvn org.pitest:pitest-maven:mutationCoverage

before_deploy:
  - POM_VERSION=$(mvn -q -Dexec.executable=echo -Dexec.args='${project.version}' --non-recursive exec:exec)

# Releases config copied from https://docs.travis-ci.com/user/deployment/releases/ and secure key generated by following
# https://stackoverflow.com/questions/25302518/travis-ci-setup-releases-with-github-token#answer-57032190
deploy:
  provider: releases
  api_key:
    secure: vycopDL8+ayubz6L5uR8Ymy+Hv3SQNy+LseyGN/Csakm/na95IDd9hkD1N2JoONYeACP1UQ4ylRAYCBDvdKFVNn89cQ6vhZKEFtr6/0lv8sJscHUTTwuKcrLehD6OwQXu7xbEhQ2nSgOllA48aKF1at6nN8BKI4dc5sYVIkTRx72rLJLQlmlFLhzRLhe5N1JXCA1p3nmixJLG0R9zkwWXP+V6X+wjym0yt/vHnV58jsSfJM8/D0PWKYmgJEQX+YwHiguCIn2gBnwRInC/jQuGpTf6gWXvTj4OzWrV4eLddTpSHoPZpu0vnU0feSPoDtFvLsP90REpTdSaB6he+OfIAY2GuToBGpsMI9BawmDpcXAguu9Kzw46xulGOVaoX+5f6F0/20+er57fHYal+Wj7K2Cg39tgj02xl3Z8hVMLIsLDCCARtmK/OIPWEmeTAFLG85ri07rjzyrnMfvz3Gpay82gOgZSmoG2hkzkDTJZus40NZpmBta8mMyR/JoIGjA0bcORun3wHKQ+gZcSQXuHz9KVv7ld3WQHlTu33FPP/TCjE1Inz/qYh3t3uSqQKzKPhOnP6CPOvdNOzgb9vCpw4+bqp68lpl5CJJD8CJgNvrmVGc9H8OdsjBK63DL0tc0iWw4Zv9OtPDZC2+3anB86Zp/pBFpXza7D73n6Gs4o0s=
  file: "target/spt-development-cid-${POM_VERSION}.jar"
  skip_cleanup: true
  on:
    tags: true